Bootstrap: library
From: bartosz_bartmanski/default/r-base:4.0.3

%files
    ./gen_igraph_input.R /scripts/
    ./run_carnival.R /scripts/
    ./carnival_example.json /config/

%post
    apt -y update
    apt -y install libhdf5-dev graphviz

    R -e 'install.packages(c("remotes", "igraph", "rjson", "BiocManager"), 
    repos = c(CRAN = "https://cloud.r-project.org"))'
    R -e 'remotes::install_github("saezlab/CARNIVAL@963fbc1db2d038bfeab76abe792416908327c176")'
    R -e 'BiocManager::install("rhdf5")'

    echo "Done!"

%environment
    export LC_ALL=C

%runscript
	echo "Running an example"
    /scripts/gen_igraph_input.R 10 8 3 3 Erdos example_input.h5
    /scripts/run_carnival.R example_input.h5 example_result.Rds /config/carnival_example.json

