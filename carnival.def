Bootstrap: docker
From: r-base:4.0.3

%post
    apt -y update
    apt -y install libhdf5-dev graphviz git

    git clone https://github.com/BartoszBartmanski/SingularityCARNIVAL.git /scripts/

    R -e 'install.packages("remotes", repos = c(CRAN = "https://cloud.r-project.org"))'
    R -e 'remotes::install_github("rstudio/renv@0.14.0")'
    cd /scripts/
    R -e 'renv::restore()'

%environment
    export LC_ALL=C

%runscript
	echo "Running an example"
    /scripts/gen_igraph_input.R 10 8 3 3 Erdos example_input.h5
    /scripts/run_carnival.R example_input.h5 example_result.Rds /scripts/carnival_example.json

